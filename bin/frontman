#!/usr/bin/env node

// node
var path			= require('path');

// need to `npm link autocmdr`
var program  = require('commander');

// Local
var frontman = require('../lib/frontman.js');

program._name = "frontman";

program
	.version('0.0.0')
	.usage('[options] filename')
	.option('-t, --template <file>', 'Path to template file')
	.option('-r, --replace', 'Indicate that the template should replace the base')
	.option('-j, --to-json', 'Output JSON')
	.option('-c, --to-cson', 'Output CSON')
	.option('-y, --to-yaml', 'Output YAML')
	//.option('-o, --output <file>', 'File to output')
	.parse(process.argv);

var files = program.args;

if (files.length < 1 )
	frontman.render({}, program);

// TODO: Handle directories
files.forEach(function(filename) {
	var processed = frontman.render(filename, program);

	if (program.output) {
		fs.writeFile(program.output, processed, function (err) {
		  if (err) throw err;
		  console.log('It\'s saved!');
		});
	} else {
		console.log(processed);
	}
});

